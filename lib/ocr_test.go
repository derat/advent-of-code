// Copyright 2022 Daniel Erat.
// All rights reserved.

package lib

import (
	"strings"
	"testing"
)

func TestOCR(t *testing.T) {
	for _, tc := range []struct {
		desc, input, want string
	}{
		{
			"2016/08",
			`
#  # ###   ##    ## #### #    ###   ##  #### #### 
#  # #  # #  #    # #    #    #  # #  # #       # 
#  # #  # #  #    # ###  #    ###  #    ###    #  
#  # ###  #  #    # #    #    #  # #    #     #   
#  # #    #  # #  # #    #    #  # #  # #    #    
 ##  #     ##   ##  #    #### ###   ##  #### #### `,
			"UPOJFLBCEZ",
		},
		{
			"2018/10",
			`
 ####   #####   ######  #####   #####   #####   ######     ###
#    #  #    #  #       #    #  #    #  #    #  #           # 
#       #    #  #       #    #  #    #  #    #  #           # 
#       #    #  #       #    #  #    #  #    #  #           # 
#       #####   #####   #####   #####   #####   #####       # 
#  ###  #       #       #       #       #       #           # 
#    #  #       #       #       #       #       #           # 
#    #  #       #       #       #       #       #       #   # 
#   ##  #       #       #       #       #       #       #   # 
 ### #  #       ######  #       #       #       ######   ###  `,
			"GPEPPPEJ",
		},
		{
			"2019/08 left",
			`
  ## #   #
   # #   #
   #  # # 
   #   #  
#  #   #  
 ##    #  `,
			"JY",
		},
		{
			"2019/08 right",
			`
#### #  # ####
   # #  # #   
  #  #### ### 
 #   #  # #   
#    #  # #   
#### #  # #   `,
			"ZHF",
		},
		{
			"2019/11",
			`
 ###  #  # #  # ###   ##  #  #  ##  #  #   
 #  # # #  #  # #  # #  # # #  #  # # #    
 #  # ##   #  # #  # #    ##   #    ##     
 ###  # #  #  # ###  # ## # #  # ## # #    
 # #  # #  #  # # #  #  # # #  #  # # #    
 #  # #  #  ##  #  #  ### #  #  ### #  #   `,
			"RKURGKGK",
		},
		{
			"2021/13",
			`
####  ##   ##  #  # ###  #### #  # ####
#    #  # #  # #  # #  #    # #  # #   
###  #  # #    #  # #  #   #  #### ### 
#    #### # ## #  # ###   #   #  # #   
#    #  # #  # #  # # #  #    #  # #   
#    #  #  ###  ##  #  # #### #  # ####`,
			"FAGURZHE",
		},
		{
			"banner uppercase",
			`
   #    ######   #####  ######  ####### #######  #####  #     #   ###         #
  # #   #     # #     # #     # #       #       #     # #     #    #          #
 #   #  #     # #       #     # #       #       #       #     #    #          #
#     # ######  #       #     # #####   #####   #  #### #######    #          #
####### #     # #       #     # #       #       #     # #     #    #    #     #
#     # #     # #     # #     # #       #       #     # #     #    #    #     #
#     # ######   #####  ######  ####### #        #####  #     #   ###    ##### `,
			"ABCDEFGHIJ",
		},
		{
			"banner uppercase",
			`
#    #  #       #     # #     # ####### ######   #####  ######   #####  #######
#   #   #       ##   ## ##    # #     # #     # #     # #     # #     #    #   
#  #    #       # # # # # #   # #     # #     # #     # #     # #          #   
###     #       #  #  # #  #  # #     # ######  #     # ######   #####     #   
#  #    #       #     # #   # # #     # #       #   # # #   #         #    #   
#   #   #       #     # #    ## #     # #       #    #  #    #  #     #    #   
#    #  ####### #     # #     # ####### #        #### # #     #  #####     #   `,
			// TODO: Fix 'M', 'N'.
			//"KLMNOPQRST",
			"KLHHOPQRST",
		},
		{
			"banner uppercase",
			`
#     # #     # #     # #     # #     # #######
#     # #     # #  #  #  #   #   #   #       # 
#     # #     # #  #  #   # #     # #       #  
#     # #     # #  #  #    #       #       #   
#     #  #   #  #  #  #   # #      #      #    
#     #   # #   #  #  #  #   #     #     #     
 #####     #     ## ##  #     #    #    #######`,
			"UVWXYZ",
		},
		{
			"banner lowercase",
			`
                                                                               
   ##    #####    ####   #####   ######  ######   ####   #    #     #         #
  #  #   #    #  #    #  #    #  #       #       #    #  #    #     #         #
 #    #  #####   #       #    #  #####   #####   #       ######     #         #
 ######  #    #  #       #    #  #       #       #  ###  #    #     #         #
 #    #  #    #  #    #  #    #  #       #       #    #  #    #     #    #    #
 #    #  #####    ####   #####   ######  #        ####   #    #     #     #### 
                                                                               `,
			"ABCDEFGHIJ",
		},
		{
			"banner lowercase",
			`

 #    #  #       #    #  #    #   ####   #####    ####   #####    ####    #####
 #   #   #       ##  ##  ##   #  #    #  #    #  #    #  #    #  #          #  
 ####    #       # ## #  # #  #  #    #  #    #  #    #  #    #   ####      #  
 #  #    #       #    #  #  # #  #    #  #####   #  # #  #####        #     #  
 #   #   #       #    #  #   ##  #    #  #       #   #   #   #   #    #     #  
 #    #  ######  #    #  #    #   ####   #        ### #  #    #   ####      #  
                                                                               `,
			// TODO: Fix 'M', 'N', O'.
			//"KLMNOPQRST",
			"KLHHGPQRST",
		},
		{
			"banner lowercase",
			`

 #    #  #    #  #    #  #    #   #   #  ######
 #    #  #    #  #    #   #  #     # #       # 
 #    #  #    #  #    #    ##       #       #  
 #    #  #    #  # ## #    ##       #      #   
 #    #   #  #   ##  ##   #  #      #     #    
  ####     ##    #    #  #    #     #    ######
                                               `,
			// TODO: Fix 'W'.
			//"UVWXYZ",
			"UVHXYZ",
		},
	} {
		got := OCR(NewByteGridString(strings.TrimLeft(tc.input, "\n"), '#', ' '), ' ')
		if got != tc.want {
			t.Errorf("OCR([%s]) = %q; want %q", tc.desc, got, tc.want)
		}
	}
}
